library("Hmisc")
library("Hmisc")

#pdf("fig4.pdf")

par(mar=rep(5,4))

GAIN_RR = c(24.916666666666668, 51.93333333333333, 81.4, 109.61666666666666, 148.98333333333332, 182.0, 219.0, 269.4166666666667, 315.21666666666664, 371.1333333333333, 422.5, 466.6666666666667, 527.4, 581.75, 647.6666666666666, 700.9666666666667, 750.8333333333334, 811.05, 870.35, 930.0166666666667, 994.3833333333333, 1046.9, 1102.75, 1156.95, 1224.1166666666666, 1282.5, 1341.3333333333333, 1401.0333333333333, 1455.6166666666666, 1518.35)

GAIN_FR = c(22.3125, 46.45, 70.125, 98.9125, 129.375, 162.2, 196.0125, 233.2875, 271.825, 317.275, 359.725, 404.425, 445.7875, 491.3375, 534.825, 582.925, 630.2875, 682.35, 723.15, 771.575, 805.15, 857.5666666666667, 903.6333333333333, 957.2666666666667, 1011.95, 1062.1666666666667, 1112.5, 1158.4166666666667, 1203.5, 1248.8833333333334)

GAIN_LO = c(19.760416666666668, 42.020833333333336, 63.729166666666664, 90.54166666666667, 119.0625, 148.55208333333334, 178.42708333333334, 212.66666666666666, 246.90625, 287.7604166666667, 325.4583333333333, 364.2916666666667, 401.34375, 442.6875, 483.7604166666667, 526.7291666666666, 568.3958333333334, 613.28125, 650.5833333333334, 693.84375, 718.3972602739726, 762.4657534246576, 803.6575342465753, 851.7123287671233, 902.027397260274, 947.6301369863014, 994.2602739726027, 1036.5068493150684, 1078.2328767123288, 1121.1917808219177)

GAIN_CH = c(26.140625, 53.09375, 79.71875, 111.46875, 144.84375, 182.671875, 222.390625, 264.21875, 309.203125, 361.546875, 411.125, 464.625, 512.453125, 564.3125, 611.421875, 667.21875, 723.125, 785.953125, 832.0, 888.171875, 939.8936170212766, 1005.2765957446809, 1058.9148936170213, 1121.212765957447, 1182.6808510638298, 1240.063829787234, 1296.1489361702127, 1347.7659574468084, 1398.063829787234, 1447.212765957447)

SE_GAIN_RR = c(1.07771513277276, 1.8818848904066205, 2.7493282007711555, 3.37785236120143, 4.3978843293195045, 5.600632404767638, 6.757280024783148, 8.257383760857559, 9.640562334720398, 11.44182103157179, 12.702170636898595, 13.867714971058446, 15.277331609646723, 16.23754757926482, 17.975289108064953, 18.946136858258253, 19.939061096435992, 21.539333690560937, 22.769895604357373, 24.41945371844766, 25.545934073452568, 26.411769787981523, 27.703279614314418, 28.3349775258229, 29.629752744246534, 30.18440546595764, 31.36249160429748, 33.04678697891263, 33.23182707914986, 34.128807581637616)

SE_GAIN_FR = c(0.8208316809416533, 1.552840139872743, 2.173719989729588, 2.9877796351868877, 3.9208053820293096, 4.928986330879807, 6.199634487083693, 7.429851043152715, 8.529583399483819, 10.001749651623454, 11.29908026539107, 12.71940738473102, 13.466965912871297, 14.59847190071404, 15.694397263633604, 16.811272143825107, 18.16618679782406, 19.549410956599175, 20.66487849286804, 20.750994210933303, 22.0120415376732, 30.550492661360668, 31.628165044372626, 33.43739534424604, 34.68314081718153, 36.23661694208507, 37.63897580965774, 38.783440021578876, 40.026491227685696, 40.553822575226654)

SE_GAIN_CH = c(1.309682091729319, 2.568753682897299, 3.5334249904428336, 4.79801842795137, 6.21219891868197, 7.74338347496628, 9.631532310195194, 11.117129166879637, 12.553405050544537, 14.711332553901247, 16.68314696267239, 18.92446823683231, 19.678779438750123, 21.233769939411225, 22.944957965505587, 24.672379356287994, 26.863437738111163, 29.026299948746473, 30.955305797734418, 31.864310524466745, 33.650781778119075, 47.04667362775546, 48.186429021692334, 51.38537007051745, 53.129232556941886, 55.87426390893765, 58.04514234821811, 59.50387316361954, 61.61642914561582, 62.136278447409374)

SE_GAIN_LO = c(0.9693372762542437, 1.8040379071804402, 2.5516572419245898, 3.56937435755878, 4.772921042937758, 5.998858213692272, 7.581712635760282, 9.345493690266705, 10.764959291675575, 12.609586857917206, 14.154766115712027, 15.75696299916884, 16.73988363221747, 18.164888534084906, 19.55281723000898, 20.791069000086967, 22.27577061330039, 23.725977905829104, 24.96398737199768, 24.722604853160973, 26.27609788863339, 35.89179691035055, 37.296599029735525, 39.20456275050959, 40.71654125869283, 42.37084625147102, 44.07463103553414, 45.57421272974937, 46.97487588449835, 47.67960742664398)

x30 = 1:30

errbar(x30, GAIN_FR, GAIN_FR + SE_GAIN_FR, GAIN_FR-SE_GAIN_FR, add=F, pch=15, lwd=1, cap=.005,ylim=c(0,1550),xlab="round",ylab="cumulated  wealth",cex.lab=1.3,cex=1.,col="blue",errbar.col="blue")

errbar(x30, GAIN_LO, GAIN_LO + SE_GAIN_LO, GAIN_LO-SE_GAIN_LO, add=T, pch=18, lwd=1, cap=.005,cex.lab=1.3,cex=1.,col="olivedrab4",errbar.col="olivedrab4")

errbar(x30, GAIN_CH, GAIN_CH + SE_GAIN_CH, GAIN_CH-SE_GAIN_CH, add=T, pch=17, lwd=1, cap=.005,cex.lab=1.3,cex=1.,col="darkorange",errbar.col="darkorange")

errbar(x30, GAIN_RR, GAIN_RR + SE_GAIN_RR, GAIN_RR-SE_GAIN_RR, add=T, pch=15, lwd=1, cap=.005,ylim=c(0,1550),xlim=c(0,30),xlab="round",ylab="cumulated  wealth",cex.lab=1.3,col="black",errbar.col="black")



#errbar(x30, GAIN_CH, GAIN_CH + SE_GAIN_CH, GAIN_CH-SE_GAIN_CH, add=T, pch=17, lwd=1, cap=.005,cex.lab=1.3,cex=1.,col="olivedrab4",errbar.col="olivedrab4")

legend("bottomright", col=c("black","blue","olivedrab4","darkorange"),c("RR treatment","FR treatment","reliable players","cheater players"),lwd=1,pch=c(16,15,18,17), inset=0.04,cex=1)

#dev.off()

